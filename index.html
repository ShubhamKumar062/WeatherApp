<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather App</title>
    <link rel="stylesheet" href="style.css">
    
  </head>
  <body>
    <div class="main">
      <h1>Weather App</h1>
      <div class="input-box">
      <input type="text" id="searchinput" placeholder="Enter city name" />
       
      </div>
      <button id="searchbtn">search</button>
     
    </div>
    <div id="box"></div>
    
    
    
  </body>
  <script>
    const API_KEY = "b22151b873ae1d55b47f83658f4c9152"
    const input = document.getElementById("searchinput")
    const searchbtn = document.getElementById("searchbtn")
    const weatherinfo = document.getElementById("box")

    function debounce(func, delay) {
      let timer
      return function (...args) {
        clearTimeout(timer)
        timer = setTimeout(() => func.apply(this, args), delay)
      }
    }

    
     function throttle(func, limit) {
  let inThrottle;
  return function (...args) {
    if (!inThrottle) {
      func.apply(this, args);
      inThrottle = true;
      setTimeout(() => (inThrottle = false), limit);
    }
  };
}

    async function fetchinfo(cityname) {
      
      try{
      const res= await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${cityname}&appid=${API_KEY}&units=metric`)
      const data = await res.json()
      const {name,main,weather,wind}= data
      weatherinfo.innerHTML=`
      <h1> City:<span style="font-style: italic;"> ${name}</span></h1>
      <h2> Temperature: <span style="font-style: italic;">${main.temp}Â°C</span></h2>
      <h2> Description :<span style="font-style: italic;"> ${weather[0].description}</span></h2>
      <h2> Humidity : ${main.humidity} %</h2>
      <h2> Wind Speed : ${wind.speed} m/s</h2>
     <img src="https://openweathermap.org/img/wn/${weather[0].icon}.png" alt="">
     <button id="forecastbtn">5days Forecast</button>
      `
  document.getElementById('forecastbtn').addEventListener('click', () => {
  const city = document.getElementById('searchinput').value;
  if (city) {
    localStorage.setItem('city', city);
    window.location.href = 'forcast.html';
  }
});

    }
    catch(err){
     weatherinfo.innerHTML=`<h1>${err.message}</h1>`
    }
  }
  const debouncesrch=debounce(()=>{
    const city=input.value.trim()
    fetchinfo(city)
  },500)

  input.addEventListener("keyup",(e)=>{
    if(e.key=="Enter"){
      return debouncesrch()
    }
  })

  const throttleclk=throttle(()=>{
    const city=input.value.trim()
    fetchinfo(city)
  },2000)

  searchbtn.addEventListener("click",throttleclk)
  </script>
</html>